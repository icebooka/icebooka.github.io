# t-SNE

是一种将高维的复杂数据降维为二维（或三维）的算法，用于低维空间的可视化。

## 概述

t-SNE是一种流形学习算法，用于可视化复杂数据。如下例子是将三维空间上的两个瑞士卷数据转变为二维空间的示例。

![image.png](images/1.png)

在上图体现出，t-SNE可以在低维空间展现多个结构。

## 算法说明

步骤：

1. 对于所有的组 i、j，使用高斯分布来表示 xi 和 xj 的相似度
2. 在低维空间中随机配置与 x i 相同数量的点 y i，对于所有的组 i、j，使用 t 分布表示 y i 和 y j 的相似度。
3. 更新数据点 yi，使得步骤 1 和步骤 2 中定义的相似度分布尽可能相似。
4. 重复步骤 3，直到达到收敛条件。

![image.png](images/2.png)

相似度指的是 数据点之间的相似程度，使用上图的概率分布衡量。

横轴是距离，纵轴是相似度，越近越相似。

在降低维度的情况下，使他们的相似度保持不变，这就是t-SNE的降维逻辑，此时使用的是 t 分布。

为了在低维空间中更好地表现数据点之间的距离关系，t-SNE并未简单地在高维空间和低维空间中使用相同的概率分布，而是采用了不同的方式：在高维空间中使用**高斯分布**来计算数据点的相似度，而在低维空间中使用**t分布**来衡量相似度。

选择t分布的原因在于它的**重尾特性**，这使得在低维空间中远离某个聚类中心的点不容易被压缩到中心附近，从而保持了聚类之间的分离度。因此，在低维空间中，数据点的相似度分布可以更自然地反映出聚类结构，使得不同聚类之间的距离更加明显。

在这个过程中，t-SNE通过最小化**KL散度**（Kullback-Leibler散度）来度量高维和低维空间相似度分布之间的差异，从而在降维过程中尽量保持高维空间中的相似度关系。这种方法使得t-SNE能够在低维空间中还原数据的高维结构，同时使聚类和局部关系更为清晰。

![image.png](images/3.png)

如上为更新次数是250和500的情况。

t-SNE通常用于降维到三维或者二维，在高维空间中，远离重心的点占主导地位，局部信息无法保留，因此无法降维到四维或者更高空间。

## 示例代码

```python
from sklearn.manifold import TSNE
from sklearn.datasets import load_digits
data = load_digits()
n_components = 2  # 设置降维后的维度为2
model = TSNE(n_components=n_components)
print(model.fit_transform(data.data))
```

## 详细说明

使用手写数组数据作为训练数据，对PCA，LLE，t-SNE三种方法进行降维，展现结果如下：

![image.png](images/4.png)

PCA虽然进行归类，但很混杂。

LLE适用于非线性数据，但如果数据不是像瑞士卷一样几种，就不能很好把握结构。

t-SNE 在二维空间进行了很好的分类。