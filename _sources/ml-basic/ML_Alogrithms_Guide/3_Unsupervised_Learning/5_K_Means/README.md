# k-means算法

## 概述

- 聚类：把相似的数据汇总为簇的方法

该算法是一种聚类算法。

输入是多个数据点，并设置要聚类的簇数量，例如以下：

![image.png](images/1.png)

给定图a的数据点，要求分成3簇，图中给出了三个X，代表了三个簇的中心。求簇的重心就是聚类算法的重要计算。

## 算法说明

![image.png](images/2.png)

如上图重复步骤：

- 从数据点中随机选择和簇数量相同的点，作为簇的重心
- 计算每个数据点到各重心之间的距离，将自己归类为最近的簇重心的簇
- 计算每个簇的数据点的平均值，作为新的重心。
- 重复步骤2和步骤3.知道所有数据点不改变所属的簇。

注：

有时选择的重心不好可能会导致步骤2和步骤3的训练无法顺利进行。

在随机选择的重心之间太近等的情况下，就会出现这种问题。

利用k-means++等方法，选择位置尽可能远离的数据点作为重心的初始值，就可以解决这个问题。

## 示例代码

下面是对鸢尾花数据集应用k-means算法的代码。

```python
from sklearn.cluster import KMeans
from sklearn.datasets import load_iris
data = load_iris()
n_clusters = 3  # 将簇的数量设置为3
model = KMeans(n_clusters=n_clusters)
model.fit(data.data)
print(model.labels_)  # 各数据点所属的簇
print(model.cluster_centers_)  # 通过fit()计算得到的重心
```

## 详细说明

### k-means的评估

用于评估分类的结果好坏，可以使用WCSS（簇内平方和）。也就是每个簇内的所有数据到重心距离的平方和相加的值。

WCSS越小，说明聚类结果越好。

### Elbow方法确定簇数量

对于簇数量，是作为输入的超参数，也就是我们算法名称中的k，有些数据集很难定义合适的簇数量。

我们已经知道可以使用WCSS来确定优劣，因此对于不同的簇数量，我们都可以得到一个WCSS。

![image.png](images/3.png)

纵轴是WCSS，横轴是k，可以发现，随着k的变大，WCSS会递减，但是我们可以找到一个点 3，在这个点后，WCSS的变化值显著减少，也就是选择这个点是最适合的点，这个图像类似于一个肘部，因此称作肘方法。

注：

当没有很明确的理由来确定簇的数量或对数据知之甚少时，Elbow方法很有用。不过在实际的分析中，常常不会出现图中那样明显的“肘部”，所以Elbow方法的结果只不过是一种参考而已。