# 混合高斯分布

## 概述

如果数据集中有多组数据，可以使用混合高斯分布（即多个高斯分布的线性组合）来实现聚类。

高斯分布是一种概率分布的名称，使用概率分布产生的数据估计分布参数的方法。

高斯分布认为数据的分布可以用均值和方差表示（正态分布）

- 均值：是数据的中心位置
- 方差：是数据的离散程度

混合高斯分布是以多个高斯分布的线性叠加表示数据的模型。

![image.png](images/1.png)

以上是对鸢尾花数据使用高斯分布和混合高斯分布的结果。

对于高斯分布，每个轴只有一个均值和一个方差，所以使用一个分布无法提现不同品种的差异。

对于混合高斯分布，使用了三个高斯分布叠加而成，可以表示多个类别组成的复杂数据。

## 算法说明

混合高斯分布的学习过程是从输入数据中找到每个高斯分布的均值和方差。

对于一个已经了解的高斯分布，做一维数据进行示例：

![image.png](images/2.png)

这个一维数据由两个高斯分布分类。

但实际上，混合高斯分布必须在不知道每个数据点的类别的情况下求出参数。

因此，我们需要在推测“每个数据点属于某个类别”的权重的基础上，计算出数据点的各个类别的高斯分布的参数（均值和方差）。

步骤：

- 初始化参数（各高斯分布的均值和方差）
- 对每个类别计算数据点的权重
- 根据步骤2 中计算出的权重重新计算参数
- 重复 步骤2 步骤3 ，知道步骤3更新前后的每个均值的变化够小

![image.png](images/3.png)

求解权重和参数通常使用期望最大化（Expectation-Maximization, EM）算法。在不知道数据点的类别标签的情况下，通过反复迭代估计权重和更新参数来逼近真实的高斯分布参数。

在步骤2中计算数据点拥有的权重，权重计算方法为“每个高斯分布的值/所有高斯分布的值之和“。当计算出所有数据点的权重后，求出每个类别的权重的均值，然后计算方差。

## 示例代码

```python
from sklearn.datasets import load_iris
from sklearn.mixture import GaussianMixture
data = load_iris()
n_components = 3  # 高斯分布的数量
model = GaussianMixture(n_components=n_components)
model.fit(data.data)
print(model.predict(data.data))  # 预测类别
print(model.means_)  # 各高斯分布的均值
print(model.covariances_)  # 各高斯分布的方差
```

## 详细说明

以下是对同一数据使用混合高斯分布和K-means进行聚类。

![image.png](images/4.png)

我们可以看到，混合高斯分布的数据会更优，因为高斯分布对于椭圆形数据更优，而k-means对重心开始呈圆形分布的数据会更好，因此椭圆成为了k-means的软肋，更该使用混合高斯分布。